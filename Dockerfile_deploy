FROM zhuoqiw/ros-test:latest AS test

FROM ros:galactic

COPY --from=test /opt/Galaxy_camera/lib/*/*.so /opt/Galaxy_camera/lib/*/*.cti /opt/Galaxy_camera/lib
COPY --from=test /opt/opencv/lib /opt/opencv/lib
COPY --from=test /opt/pcl/lib /opt/pcl/lib
COPY --from=test /ws/install /ws/install

RUN sed -i 's?opt/ros/$ROS_DISTRO?ws/install?g' ros_entrypoint.sh

ENV LD_LIBRARY_PATH="/opt/Galaxy_camera/lib:/opt/opencv/lib:/opt/pcl/lib:$LD_LIBRARY_PATH"
